# iVnc Configuration Example
# Copy this file to config.toml and customize as needed
#
# iVnc 使用 str0m Sans-I/O WebRTC 库，HTTP/WebSocket/ICE-TCP 共享同一端口。
# 音频捕获需要 PulseAudio/PipeWire 运行，并设置 XDG_RUNTIME_DIR 环境变量。

[display]
# Display width (0 = auto-detect from client)
width = 0
# Display height (0 = auto-detect from client)
height = 0

[http]
# HTTP server port (also used for WebSocket signaling and ICE-TCP)
port = 8008
# Enable HTTP basic authentication
basic_auth_enabled = true
# Basic auth username
basic_auth_user = "user"
# Basic auth password
basic_auth_password = "mypasswd"

[encoding]
# Target frames per second
target_fps = 30
# Maximum frames per second
max_fps = 60

[input]
# Enable keyboard input
enable_keyboard = true
# Enable mouse input
enable_mouse = true
# Enable clipboard sync
enable_clipboard = true
# Enable binary clipboard sync
enable_binary_clipboard = false
# Enable command execution from client messages
enable_commands = false
# Allowed file transfer directions (use [] or ["download"] to disable uploads)
file_transfers = ["upload", "download"]
# Directory to store uploaded files
upload_dir = "~/Desktop"
# Mouse sensitivity multiplier
mouse_sensitivity = 1.0

[audio]
# Enable audio streaming
enabled = false
# Audio sample rate (Hz)
sample_rate = 48000
# Number of audio channels (1 = mono, 2 = stereo)
channels = 2
# Audio bitrate (bits per second)
bitrate = 128000

[logging]
# Log level: "trace", "debug", "info", "warn", "error"
level = "info"
# Optional log file path (null = stdout only)
logfile = null
# Log format: "json" or "text"
format = "json"

# ============================================================================
# WebRTC Configuration (str0m Sans-I/O)
# ============================================================================

[webrtc]
# Enable WebRTC streaming (default: true)
enabled = true

# TCP-only mode (required — str0m uses ICE-lite with TCP passive candidates)
tcp_only = true

# Public candidate address for ICE-TCP (recommended for public/NAT deployments)
# The browser needs a routable address to connect. If not set and
# candidate_from_host_header is true, the Host header from the HTTP request
# is used to construct the candidate address.
# public_candidate = "1.2.3.4:8008"

# Allow candidate override from Host header (useful behind reverse proxies)
candidate_from_host_header = true

# Video codec: "h264", "vp8", "vp9", "av1"
video_codec = "h264"

# Target video bitrate in kbps
video_bitrate = 4000

# Maximum video bitrate in kbps
video_bitrate_max = 8000

# Minimum video bitrate in kbps
video_bitrate_min = 500

# Hardware encoder: "auto", "software", "vaapi", "nvenc", "qsv"
# - auto: Automatically detect best available encoder
# - software: Use CPU-based encoding (x264enc, vp8enc, etc.)
# - vaapi: Intel/AMD VA-API hardware encoding
# - nvenc: NVIDIA NVENC hardware encoding
# - qsv: Intel Quick Sync Video hardware encoding
hardware_encoder = "auto"

# GStreamer pipeline latency in milliseconds
pipeline_latency_ms = 50

# Keyframe interval in frames (lower = more keyframes = better error recovery)
keyframe_interval = 60
